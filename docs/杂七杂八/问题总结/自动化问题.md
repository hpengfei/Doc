> 蓝绿发布、灰度发布/金丝雀发布、滚动发布

**蓝绿发布**： 项目逻辑上分为AB组，在版本升级时，首先把A组从负载均衡中摘除，进行新版本的部署。B组仍然继续提供服务。  当A组升级完毕，负载均衡重新接入A组，再把B组从负载列表中摘除，B组进行新版本的部署。A组重新提供服务。  最后，B组也升级完成，负载均衡重新接入B组，此时，AB组版本都已经升级完成，并且都对外提供服务。 

特点： 发布策略简单；  用户无感知，平滑过渡；  升级/回滚速度快。 

缺点： 需要准备正常业务使用资源的两倍以上服务器，防止升级期间单组无法承载业务突发； 如果出问题，影响范围较大； 

**灰度发布**： 灰度发布只升级部分服务，即让一部分用户继续用老版本，一部分用户开始用新版本，如果用户对新版本没什么意见，那么逐步扩大范围，把所有用户都迁移到新版本上面来。 

特点： 保证整体系统稳定性，在初始灰度的时候就可以发现、调整问题，影响范围可控；  新功能逐步评估性能，稳定性和健康状况，如果出问题影响范围很小，相对用户体验也少；  用户无感知，平滑过渡。 

缺点： 自动化要求高 

**滚动发布**： 在升级过程中，并不一下子启动所有新版本，是先启动一台新版本，再停止一台老版本，然后再启动一台新版本，再停止一台老版本，直到升级完成，这样的话，如果日常需要10台服务器，那么升级过程中也就只需要11台就行了。 

但是滚动升级有一个问题，在开始滚动升级后，流量会直接流向已经启动起来的新版本，但是这个时候，新版本是不一定可用的，比如需要进一步的测试才能确认。那么在滚动升级期间，整个系统就处于非常不稳定的状态，如果发现了问题，也比较难以确定是新版本还是老版本造成的问题。 

> 如何用 jenkins 升级/回退版本

发布： jenkins配置好代码路径（SVN或GIT），然后拉代码，打tag。需要编译就编译，编译之后推送到发布服务器（jenkins里面可以调脚本），然后从分发服务器往下分发到业务服务器上。 

回滚： 按照版本号到发布服务器找到对应的版本推送







